<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <link rel="stylesheet" href="/static/bootstrap-5.3.2-dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="/static/bootstrap-5.3.2-dist/js/bootstrap.min.js">

        <link rel="icon" type="image/x-icon" href="/static/resources/favicon.ico">

        <title>{{.Title}}</title>
    </head>
    <body>
        {{template "navbar.html" .}}

        <div align="center" class="container">
            <h1>{{.Title}}</h1>
            <p>{{.Content}}</p>

            <div style="width:50%; height: 50%;">
                <canvas id="chart"></canvas>
            </div>
            
            <script src="/static/chartjs-4.4.2/Chart.min.js"></script>
            
            <script>
            const ctx = document.getElementById('chart');

            let idArr = [], rArr = [];

            fetch('/get_users_result_data').then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            }).then(data => {
                data.forEach(item => {
                    idArr.push(item.ID);
                    rArr.push(item.RESULT);
                });

                new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: idArr,
                        datasets: [{
                        label: 'User Earnings',
                        data: rArr,
                        borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: false,
                            text: 'Chart.js Doughnut Chart'
                        }
                        }
                    }
                });
            }).catch(error => {
                console.error('There was a problem with the fetch operation: ', error);
            });
            </script>
        </div>

        <script src="/static/bootstrap-5.3.2-dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>